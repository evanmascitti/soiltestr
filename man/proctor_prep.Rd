% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/proctor_prep.R
\name{proctor_prep}
\alias{proctor_prep}
\title{Simplify the process of adding water to soil compaction specimens}
\usage{
proctor_prep(
  x,
  date,
  w_int = 0.02,
  assumed_d_max = 2.2,
  n_cylinders = 5,
  cylinder_volume_cm3 = 940
)
}
\arguments{
\item{x}{a data frame, see Details for required columns}

\item{date}{date of actual compaction test}

\item{w_int}{water content interval between successive compaction points,
defaults to 0.02 (i.e. 2\%)}

\item{assumed_d_max}{a conservatively high estimate of the maximum density
that will be achieved in this test. Defaults to 2.25.
g/cm\ifelse{html}{\out{<sup>3</sup>}}{\eqn{^3}{^3}}}

\item{cylinder_volume_cm3}{volume of the compaction mold in
cm\ifelse{html}{\out{<sup>3</sup>}}{\eqn{^3}{^3}}. Used to compute compacted
volume of soil plus 0.25" of "over-pack" extending above the top of the
4.5"-high mold.}
}
\value{
A tibble with one row per aliquot. If there are soils with water
content exceeding the minimum value desired, a negative number will populate
the \code{w_to_add_g} column.
}
\description{
Pass in a tibble of specimen information and compute the amount
of water to add via bulk addition or spray bottle.
}
\details{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

When preparing soil for compaction testing, it is often desired to
mix the specimens to known water contents, rather than "eyeballing" the
water additions. This ensures the water contents of the test specimens
tested will bracket the optimum water content and be spaced along a roughly
equal range. Some \emph{a priori} knowledge about the soil is needed to predict
what this range will be. \code{proctor_prep()} allows the user to specify
the interval between 5 successive water contents to use along with the
anticipated maximum density. Returned table contains information about the
mass of soil to prepare and how much water to add.

Multiple tests are often performed in the same day and at multiple
compaction efforts. For this reason, the data frame passed to
\code{proctor_prep()} should contain the following columns:
\itemize{
\item \code{sample_name} a unique identifier
between the samples tested, i.e. mix number or name - \code{w_extant} the current
water content of the soil (g/g)
\item \code{effort}: a character string specifying the type of compactive effort,
i.e. "standard", "modified", or "reduced"
\item \code{est_w_opt} the estimated optimum water
content for the compaction effort to be tested.
}

Note that \code{w_opt} for the standard effort is commonly ~ 90\% of the plastic
limit. \code{w_opt} for the modified effort is typically 3-4 \% below that for the
standard effort.

The data frame passed to \code{x} can be easily prepared using
\code{\link[dplyr:mutate-joins]{dplyr::left_join()}} if the data are already in R, as demonstrated in
the examples, or by using \code{\link[tidyr:expand]{tidyr::crossing()}} to generate all combinations
of \code{effort} and \code{sample_name}, then adding a data frame column containing the
water contents. The standard \code{w_opt} can be estimated in one of two ways:
\itemize{
\item Gradually add water to a ~ 25 mL soil specimen until it appears close to
the optimum water content. Take a representative sample and measure the
water content via oven-drying
\href{https://www.astm.org/Standards/D2216.htm}{ASTM 2216 - 19}
\item Perform a plastic limit test and estimate \code{w_opt} as 90\% of this value.
This routine is demonstrated in the examples.
}

Using a battery-powered spray bottle increases the uniformity of water
throughout the soil, and improves the efficiency of the process. The
\code{spray_flo_rate_cm3_sec} argument allows the user to specify the flow rate
of the bottle, if used.

The \code{assumed_d_max} argument is used to ensure enough soil is mixed for each
water content. All the aliquots use the same oven-dry soil mass for mixing
purposes; more soil will be left over for points very dry or wet of optimum.
}
\examples{
# prepare tibble from existing water contents and estimated w_opt values (these
# should be estimated visually and confirmed w, but are simply typed here for demonstration)
library(tibble)
library(dplyr)
library(tidyr)

w_extant_values <- tibble(
  sample_name = paste0("mix_0", 1:3),
  w_extant = c(0.048, 0.057, 0.062))

PL_values <- tibble(
  sample_name = paste0("mix_0", 1:3),
  PL= c(0.095, 0.10, 0.14),
  standard = 0.9*PL,
  modified= standard - 0.03)

w_info <- w_extant_values \%>\%
  left_join(PL_values) \%>\%
  select(-PL) \%>\%
  pivot_longer(cols= c(standard:modified),
               names_to =  'effort',
               values_to = 'est_w_opt')\%>\%
  select(sample_name, effort, everything()) \%>\%
  arrange(desc(effort))

# generate the reference table
proctor_prep(df= w_info, date= Sys.Date())

# widen the interval for a clayey soil
mix_03 <- w_info \%>\%
  filter(sample_name == 'mix_03')
proctor_prep(df= mix_03, date= Sys.Date(), w_int = 0.025)

# the function works fine with only one compaction effort but be sure this is
# still one of the columns
mix_03 \%>\%
  filter(effort == 'modified') \%>\%
  proctor_prep(date= Sys.Date())


}
\references{
\href{https://www.astm.org/Standards/D698.htm}{ASTMc D698-12e2}
}
\seealso{
\code{\link[=proctor_fit]{proctor_fit()}}, \code{\link[=mix_calcs]{mix_calcs()}}, \code{\link[=proctor_datasheet]{proctor_datasheet()}}
}
